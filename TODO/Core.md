光明阵营优势在生产，发育，防守，治疗，拆塔
体现在：worker采集效率高，generator生产效率高，单位偏血量和治疗；对建筑伤害提升（不包括水晶）
但是，其convertor效率低



黑暗阵营优势在进攻，掠夺
体现在：移速高，对单位攻击力提升，convertor效率高
但是，其单位血量低，generator效率低，worker效率低，对建筑伤害降低（不包括水晶）
黑暗兵种击败敌人获取一定数量的黑暗能量。


游戏以波数为主，守护水晶，波数越多分数越高。
资源系统：大部分自然资源都是可再生资源，少部分属于植物大战僵尸的阳光那种，随机掉落地面刷新，有存在时限，玩家需要开采收集。
而建造和召唤所需的资源大部分通过生产或者转化获取。





敌人 AI 系统
我想实现以下结构的ecs rts ai：

1. 敌人的各个兵种有不同的生成间隔，基于波次和难度预先设定；
2. 敌人的ai最小管理单位是team，一个team由若干个固定个数的敌人组成，组成成分基于波次和难度预先设定；
3. team有4类，gather，attack，defense，harass。每当有一个敌方unit生成后，根据当前strategy和该unit种类和该unit属于哪个基地entity将该unit加入到指定缺人team，并令其移动到指定位置（基地内部集结地）。所有缺人team的entity存储在基地entity的4个buffer中（对应4类team）。
4. 所有种类的team在一个波次有最高上限数量，基于难度提前指定，attack team除外。这就是说，当其他3个team都已经达到上限数量时，所有后生成的兵种全部加入attack team。
5. strategy有4x3x2x1=24种，如gadh是指优先将生成的兵种加入gather team（如果其兵种种类合适，并且gather team有空缺或者gather team未达上限数量，否则下一个team），括号内的条件不满足，则加入attack team，以此类推。ahdg是最激进的策略，因为它优先加入attack。（首字母排列）
6. strategy按照波数和难度预先设定，每个波次内无论场上局势如何都不会改变（这个后面有条件改成根据当前场上局势设定，现在先完成最基础的）;
7. 所有unit有自己的状态机，这个与该ai系统无关，是其他系统实现的，只是拿过来用接口。unit有状态idle，interact（attack，heal，harvest），moving，garrison。这部分已经实现了。
8. 每个team都有他自己的状态，但所有team的状态机类似。team状态有如下几种：空闲/非空闲：当前队伍中只要有一个unit不处于idle状态就认为整个team非空闲；缺人/非缺人：当前队伍的unit数量小于指定数量的一半则缺人。
9. team的状态机：检查是否空闲，非空闲则返回不管（因为这意味着单位有目标，交给底层ai处理）。空闲时，检查是否缺人，缺人则命令其返回基地指定位置，并将该team的entity加入到基地缺人team的buffer中。不缺人，则根据当前team种类，寻找目标，并设定前往目标（前往目标只需对该team每个unit发个command指令即可，剩下的工作交给底层系统）。
10. 4类team各自的目标：gather team目标为resource，attack team目标为玩家水晶（水晶有专门的tag），defense目标为该team所属基地的可驻扎(有garrison tag)且未满员的建筑以及基地附近点位（这个只需在指定半径处随机选择一个点即可），harass team目标为当前场上不在玩家基地的采集单位（这些单位有一个监视系统，只要远离基地则会带上一个tag），以及基地附近指定半径处的随机点位。
选择目标时，有一个value系统，根据预先设定的权重，和各个目标身上的component数据，计算出value存储到其value component。目标选择时需要相对的选择一个较大value的目标。


待完成 ！！！
机制支持：

Buff system ：
范围性bufftrigger ： 通过类似sight的机制，同步一个collider与trigger，检查其碰撞到的单位，并未他们添加buff


Fog of war：
1. 光明阵营只有骑兵、信标、水晶不会hide in fog和提供视野，其他单位会hide in fog。
2. 暂时性buff似的视野：生成一个sight并同步它和目标的位置
3. 所有hide in fog的单位不再selectable；不在clickable？怎么实现？（可以先不管，当成不怎么重要的bug）
4. 当玩家阵营为光明时启动hide in fog系统，否则只是启动效果系统



对于我的光暗之战rts，我还有最后3天。游戏基本机制的积木已经全部准备好，现在缺的是将他们拼在一起。我的ecsrts支持超大地图，超多单位，地图随机生成生态群落，不同生态群落有不同的资源；敌人的生成方式是根据预设生成间隔逐渐减小，生成单位逐渐变强；敌人建筑是根据预设生成间隔逐渐减小，一次性生成一个建筑群。
游戏支持两个阵营：光明或者黑暗。兵种有5种：盾，骑，弓，魔法，采集；

敌人总AI：根据难度指定固定总波数，波的间隔是预设的（逐渐减小），敌人单位的生成随波数生成间隔减小，生成单位变多，阶级提升；

|阵营特色 |玩家方 | AI方|

|光明阵营|视野受限=光明受限，唯有骑兵（可多）、信标（可多）、水晶（唯一）周围范围内可见敌人；视野范围外玩家不可操控兵种但是兵种始终可见；|敌人没有玩家基本建筑的视野，策略偏防御，只有被某个单位看见的黑暗水晶会被打上暴露tag，被打上tag的水晶将成为attack目标。在存在目标之前，敌人只有defend队伍，采集队伍，和harass队伍，harass队伍的ai是全局随机选择一个一个位于玩家水晶周围一定范围内的随机点奔赴，用以模拟探查，随着时间增加，搜索范围将越来越小；敌人的建筑是预设的，且不会动态生成；敌人召唤的单位逻辑不变；此时波数不再显示给玩家，而只作为难度随时间提升的参考。|

|黑暗阵营|全局视野；但是黑暗兵种在强光明范围内（即光明骑兵、信标、水晶范围）会受到极大削弱（攻击力削减一半，血量减少一半）| 敌人拥有玩家所有信标和水晶的视野，策略偏进攻，harass队伍目标是暴露在基地之外的单位。敌人的建筑随波数生成，固定波数之后生成结束（随难度定制波数），每次生成都是一个建筑群，包含一个或多个黑暗水晶。玩家防守住指定波数并击毁所有黑暗水晶获取胜利。

天网： 黑暗单位在光明中属性削弱，hp上限 -30%， 移动速度减少 10%
迷失 ：光明单位在黑暗中血量逐渐减少且会丢失视野内所有目标(包括建筑)

建筑造成的伤害为魔法伤害；

兵种特色如下表：
工人兵种互相克制，骑兵互相克制；
光盾克制黑暗魔法， 黑暗盾克制光明魔法；
光弓克制黑暗盾，黑暗弓克制光明盾；
光魔法克制黑暗弓， 黑暗魔法克制光明弓；

| 兵种                | 光明阵营                                              | 黑暗阵营       |        
|---------------------|------------------------------------------------------|----------------------|
|盾总体特性        | 血量厚，移速低，主动攻击力为0| |
|  盾1阶                 | 给附近范围内友方单位提供一定数额的护盾，该护盾可以叠加，离开范围后失效；被击破后，脱战状态恢复护盾额度；该护盾是次数盾，会被buff消耗次数，次数盾不可叠加；
护盾被击破后，以自身血量分担队友收到的伤害 * 2。   | 嘲讽范围内的敌人攻击自己并随机选择3个没有该debuff的被嘲讽的目标施加debuff：攻击力百分比下降；|
| 盾2阶                | 护盾额度提升 ；被护盾守护单位收到的魔法伤害减少0.5                          | 增大嘲讽范围，增加攻击力百分比下降额度，反弹0.5魔法伤害|
|盾 3阶              |  护盾额度提升；被护盾守护的单位免疫魔法伤害     |攻击力下降额度提升； 反弹收到的魔法伤害 |
|弓总特性 |血量薄， 移速中， 范围远 ， 单体高伤（光明），单体速伤（黑暗）       | |
|弓1阶| 所有造成的伤害为百分比伤害（克制黑暗盾嘲讽）（对建筑不生效）；|造成伤害后会造成流血，持续流失伤害，该流失效果可叠加（但有持续时间，根据弓箭手的攻击频率设定，鼓励玩家多召唤弓箭手才能放大收益） |
|弓2阶| 百分比伤害提升， | 流血效果、速度、持续时间提升|
|弓3阶| 有一定几率造成一击必杀（对建筑不生效）| 一定几率一次发出多支箭（1-3）
|魔法总特性| 血量薄， 移速中， 范围中， 群体伤害，对3-5 -9个视野内的单位造成伤害， 群体回复， 唯一一个有2个兵种种类的单位| |
|魔法1阶纯攻| 光明魔法附加效果：被光明魔法攻击伤害到的单位攻速下降，不可叠加 |黑暗魔法附加效果 ： 被伤害到的单位恢复效果降低，不可叠加，天生黑魔法拥有更高的攻击力|
|魔法2阶纯攻| 光明魔法附加效果：被光明魔法攻击伤害到的单位攻速下降程度提高，不可叠加 |黑暗魔法附加效果 ： 被伤害到的单位恢复效果降低提高，不可叠加，攻击力增长提升|
|魔法3阶纯攻| 光明魔法附加效果：被光明魔法伤害到的单位将静默一段时间无法进攻，有冷却时间 |黑暗魔法附加效果 ： 被伤害到的单位受到的治疗效果将变成伤害，有持续时间|
|魔法1阶纯治疗| 光明治疗附加效果：驱散单位身上的debuff|黑暗魔法治疗效果：提供给单位一个保命符，当受到必杀一击时消耗，不可叠加，有持续时间|
|魔法2阶纯治疗| 光明治疗附加效果：驱散单位身上的debuff，并有持续恢复效果，可被攻击打断；|黑暗魔法治疗效果：提供给单位一个保命符，当受到必杀一击时消耗，不可叠加，持续时间延长|
|魔法3阶纯治疗| 光明治疗附加效果：驱散单位身上的debuff，持续恢复效果不可被打断|黑暗魔法治疗效果：提供给单位一个保命符，当受到必杀一击时消耗，并恢复一定血量|

|工人总特性| 血量低， 移速中，近战；唯一可以开采资源的单位| |
|工人1阶| 光明特性 ：减少可再生资源的再生时间， 增加单次采集量，只能采集光明阵营资源和中立资源 | 黑暗特性 ： 可采集所有类型资源，增加光明阵营资源的再生时间
|工人2阶 | 减少进一步增加， 采集量进一步增加 | 增加光明阵营可再生资源的再生时间提升
|工人3阶| 有一定概率可再生资源不进入再生状态，采集时有几率双倍采集 | 被采集过的光明资源将进入腐化状态，在该工人死亡前无法被光明阵营采集|



| 骑总体特性              | 血量中，移速快，主动攻击力中等| |
|  骑1阶             | 开拓 ： 如果不在光明中，将会燃烧自身10%的血量提供10秒的光明| 征服： 如果在在光明中消耗自身血量10%的血量使周围的友方免疫光明的侵袭10秒|               
| 骑兵2阶             | 消耗血量20%提供20秒的光明 ，死亡后将留存5秒的光明 |   消耗自身血量20%使周围友方免疫光明侵袭20秒；对信标的攻击将会附加3秒的失明效果，失明效果可刷新不可叠加|
|骑兵3阶|  如果不在光明中，燃烧自身30%血量提供30秒的光明，死后留存10秒的光明；| 消耗自身30%血量使周围友方免疫光明侵袭30秒，对信标的攻击将会附加5秒的失明效果，失明效果可刷新不可叠加|




当前目标：

玩家为光明阵营时env，resource，敌人隐藏与fow中